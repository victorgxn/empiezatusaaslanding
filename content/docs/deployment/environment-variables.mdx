---
title: Variables de Entorno en Producción
description: Configura variables de entorno para producción
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Tabs, Tab } from 'fumadocs-ui/components/tabs';

# Variables de Entorno en Producción

Guía completa para configurar variables de entorno en producción.

## Variables requeridas

<Tabs items={['Better Auth + PostgreSQL', 'Supabase']}>
  <Tab value="Better Auth + PostgreSQL">
    ```bash
    # App
    NEXT_PUBLIC_APP_URL="https://tuapp.com"

    # Database
    DATABASE_URL="postgresql://user:pass@host:5432/db?sslmode=require"

    # Better Auth
    BETTER_AUTH_SECRET="secreto-de-produccion-muy-largo"
    BETTER_AUTH_URL="https://tuapp.com"

    # OAuth (producción)
    GOOGLE_CLIENT_ID="xxx.apps.googleusercontent.com"
    GOOGLE_CLIENT_SECRET="GOCSPX-xxx"
    GITHUB_CLIENT_ID="xxx"
    GITHUB_CLIENT_SECRET="xxx"

    # Stripe (producción)
    STRIPE_SECRET_KEY="sk_live_xxx"
    STRIPE_WEBHOOK_SECRET="whsec_xxx"
    NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="pk_live_xxx"

    # Resend
    RESEND_API_KEY="re_xxx"
    EMAIL_FROM="noreply@tudominio.com"
    ```
  </Tab>

  <Tab value="Supabase">
    ```bash
    # App
    NEXT_PUBLIC_APP_URL="https://tuapp.com"

    # Supabase
    NEXT_PUBLIC_SUPABASE_URL="https://xxx.supabase.co"
    NEXT_PUBLIC_SUPABASE_ANON_KEY="eyJxxx"
    SUPABASE_SERVICE_ROLE_KEY="eyJxxx"

    # Stripe (producción)
    STRIPE_SECRET_KEY="sk_live_xxx"
    STRIPE_WEBHOOK_SECRET="whsec_xxx"
    NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="pk_live_xxx"

    # Resend
    RESEND_API_KEY="re_xxx"
    EMAIL_FROM="noreply@tudominio.com"
    ```
  </Tab>
</Tabs>

## Diferencias desarrollo vs producción

| Variable | Desarrollo | Producción |
|----------|------------|------------|
| `NEXT_PUBLIC_APP_URL` | `http://localhost:3000` | `https://tuapp.com` |
| `STRIPE_SECRET_KEY` | `sk_test_...` | `sk_live_...` |
| `DATABASE_URL` | Local/Docker | Neon/Railway/etc. |
| `BETTER_AUTH_URL` | `http://localhost:3000` | `https://tuapp.com` |

## Seguridad

<Callout type="error">
  Nunca expongas secretos en el cliente. Solo variables con prefijo `NEXT_PUBLIC_` son accesibles en el navegador.
</Callout>

### Variables públicas (cliente)
- `NEXT_PUBLIC_APP_URL`
- `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY`
- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`

### Variables privadas (servidor)
- `DATABASE_URL`
- `STRIPE_SECRET_KEY`
- `STRIPE_WEBHOOK_SECRET`
- `BETTER_AUTH_SECRET`
- `SUPABASE_SERVICE_ROLE_KEY`
- `RESEND_API_KEY`

## Generar secretos seguros

```bash
# Para BETTER_AUTH_SECRET
openssl rand -base64 32

# Alternativa con Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

## Configurar en Vercel

1. Ve a tu proyecto en Vercel
2. **Settings > Environment Variables**
3. Agrega cada variable
4. Selecciona los entornos (Production, Preview, Development)

## Validar variables

```typescript title="lib/env.ts"
import { z } from "zod";

const envSchema = z.object({
  NEXT_PUBLIC_APP_URL: z.string().url(),
  DATABASE_URL: z.string().min(1),
  STRIPE_SECRET_KEY: z.string().startsWith("sk_"),
  STRIPE_WEBHOOK_SECRET: z.string().startsWith("whsec_"),
  RESEND_API_KEY: z.string().startsWith("re_"),
});

export const env = envSchema.parse({
  NEXT_PUBLIC_APP_URL: process.env.NEXT_PUBLIC_APP_URL,
  DATABASE_URL: process.env.DATABASE_URL,
  STRIPE_SECRET_KEY: process.env.STRIPE_SECRET_KEY,
  STRIPE_WEBHOOK_SECRET: process.env.STRIPE_WEBHOOK_SECRET,
  RESEND_API_KEY: process.env.RESEND_API_KEY,
});
```

## Actualizar después del deploy

Si cambias variables de entorno en Vercel:

1. Actualiza la variable en el dashboard
2. Redeploy la aplicación (el cambio no se aplica automáticamente)

```bash
# Redeploy desde CLI
vercel --prod
```

O desde el dashboard: **Deployments > ... > Redeploy**
